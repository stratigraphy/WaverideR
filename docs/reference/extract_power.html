<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extract power from a wavelet spectra — extract_power • WaverideR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Extract power from a wavelet spectra — extract_power"><meta property="og:description" content="Extracts the  spectral power from a wavelet spectra in the depth domain using a traced period
and boundaries surround the traced period.
The extraction of spectral is useful for cyclostratigraphic studies because the spectral power of an
astronomical cycle is modulated by higher order astronomical cycles.
The spectral power record from an astronomical cycle can thus be used as a proxy for
amplitude modulating cycles
The traced period result from the track_period_wavelet
function with boundaries is used to extract spectral power in the depth domain from a wavelet spectra."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WaverideR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stratigraphy/WaverideR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract power from a wavelet spectra</h1>
    <small class="dont-index">Source: <a href="https://github.com/stratigraphy/WaverideR/blob/HEAD/R/extract_power.R" class="external-link"><code>R/extract_power.R</code></a></small>
    <div class="hidden name"><code>extract_power.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extracts the  spectral power from a wavelet spectra in the depth domain using a traced period
and boundaries surround the traced period.
The extraction of spectral is useful for cyclostratigraphic studies because the spectral power of an
astronomical cycle is modulated by higher order astronomical cycles.
The spectral power record from an astronomical cycle can thus be used as a proxy for
amplitude modulating cycles
The traced period result from the <code><a href="track_period_wavelet.html">track_period_wavelet</a></code>
function with boundaries is used to extract spectral power in the depth domain from a wavelet spectra.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extract_power</span><span class="op">(</span></span>
<span>  tracked_period_curve <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scalogram <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  period_up <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  period_down <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  tracked_cycle_period <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extract_cycle_power <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-tracked-period-curve">tracked_period_curve<a class="anchor" aria-label="anchor" href="#arg-tracked-period-curve"></a></dt>
<dd><p>Traced period result from the <code><a href="track_period_wavelet.html">track_period_wavelet</a></code> or <code><a href="track_period.html">track_period</a></code>
function completed using the <code><a href="completed_series.html">completed_series</a></code>.
The input can be pre-smoothed using the the <code><a href="loess_auto.html">loess_auto</a></code> function.</p></dd>


<dt id="arg-scalogram">scalogram<a class="anchor" aria-label="anchor" href="#arg-scalogram"></a></dt>
<dd><p>Wavelet or superlet object created using the <code><a href="analyze_wavelet.html">analyze_wavelet</a></code> or
or <code><a href="track_period.html">track_period</a></code> function.</p></dd>


<dt id="arg-period-up">period_up<a class="anchor" aria-label="anchor" href="#arg-period-up"></a></dt>
<dd><p>Upper period as a factor of the to be extracted power <code>Default=1.2</code>.</p></dd>


<dt id="arg-period-down">period_down<a class="anchor" aria-label="anchor" href="#arg-period-down"></a></dt>
<dd><p>Lower period as a factor of the to be extracted power <code>Default=0.8</code>.</p></dd>


<dt id="arg-tracked-cycle-period">tracked_cycle_period<a class="anchor" aria-label="anchor" href="#arg-tracked-cycle-period"></a></dt>
<dd><p>Period of the tracked cycle (make sure that
<code>tracked_cycle_period</code>) and <code>extract_cycle_power</code>) are of the same
unit (either depth or time domain).</p></dd>


<dt id="arg-extract-cycle-power">extract_cycle_power<a class="anchor" aria-label="anchor" href="#arg-extract-cycle-power"></a></dt>
<dd><p>Period of the cycle for which the power will be
extracted (make sure that <code>extract_cycle_power</code>) and
<code>tracked_cycle_period</code>) are of the same unit (either depth or time domain).</p></dd>


<dt id="arg-wavelet">wavelet<a class="anchor" aria-label="anchor" href="#arg-wavelet"></a></dt>
<dd><p>Wavelet object created using the <code><a href="analyze_wavelet.html">analyze_wavelet</a></code> function.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a matrix with 3 columns.
The first column is depth/time.
The second column is extracted power.
The third column is extracted power/total power.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Angi Roesch and Harald Schmidbauer (2018). WaveletComp: Computational
Wavelet Analysis. R package version 1.1.
<a href="https://CRAN.R-project.org/package=WaveletComp" class="external-link">https://CRAN.R-project.org/package=WaveletComp</a></p>
<p>Gouhier TC, Grinsted A, Simko V (2021). R package biwavelet: Conduct Univariate and Bivariate Wavelet Analyses. (Version 0.20.21),
<a href="https://github.com/tgouhier/biwavelet" class="external-link">https://github.com/tgouhier/biwavelet</a></p>
<p>Torrence, C., and G. P. Compo. 1998. A Practical Guide to Wavelet Analysis.
Bulletin of the American Meteorological Society 79:61-78.
<a href="https://paos.colorado.edu/research/wavelets/bams_79_01_0061.pdf" class="external-link">https://paos.colorado.edu/research/wavelets/bams_79_01_0061.pdf</a></p>
<p>Routines for astrochronologic testing, astronomical time scale construction, and
time series analysis &lt;doi:10.1016/j.earscirev.2018.11.015&gt;</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Code based on the reconstruct function of the 'WaveletComp' R package
which is based on the wavelet 'MATLAB' code written by Christopher Torrence and Gibert P. Compo.
The assignment of the standard deviation of the uncertainty of the wavelet
is based on the work of Gabor (1946) and Russell et al., (2016)
The functionality of this function is is inspired by the
<a href="https://rdrr.io/pkg/astrochron/man/integratePower.html" class="external-link">integratePower</a> function of the 'astrochron' R package.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Extract the power of the 405 kyr eccentricity cycle from the the magnetic</span></span></span>
<span class="r-in"><span><span class="co"># susceptibility data set of De pas et al., (2018)</span></span></span>
<span class="r-in"><span><span class="co">#Perform the CWT on the magnetic susceptibility data set of Pas et al., (2018)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mag_wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="analyze_wavelet.html">analyze_wavelet</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mag</span>,</span></span>
<span class="r-in"><span>dj <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>lowerPeriod <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>upperPeriod <span class="op">=</span> <span class="fl">254</span>,</span></span>
<span class="r-in"><span>verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>omega_nr <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Track the 405 kyr eccentricity cycle in a wavelet spectra</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#mag_track &lt;- track_period_wavelet(astro_cycle = 405,</span></span></span>
<span class="r-in"><span><span class="co">#                                   wavelet=mag_wt,</span></span></span>
<span class="r-in"><span><span class="co">#                                   n.levels = 100,</span></span></span>
<span class="r-in"><span><span class="co">#                                   periodlab = "Period (metres)",</span></span></span>
<span class="r-in"><span><span class="co">#                                   x_lab = "depth (metres)")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Instead of tracking, the tracked solution data set mag_track_solution</span></span></span>
<span class="r-in"><span><span class="co">#is used</span></span></span>
<span class="r-in"><span><span class="va">mag_track</span> <span class="op">&lt;-</span> <span class="va">mag_track_solution</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mag_track_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="completed_series.html">completed_series</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  wavelet <span class="op">=</span> <span class="va">mag_wt</span>,</span></span>
<span class="r-in"><span>  tracked_period_curve <span class="op">=</span> <span class="va">mag_track</span>,</span></span>
<span class="r-in"><span>  period_up <span class="op">=</span> <span class="fl">1.2</span>,</span></span>
<span class="r-in"><span>  period_down <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>  extrapolate <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  genplot <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in approx(x = out[, 1], y = out[, 2], xout = seq, method = "linear",     yleft = yleft_out, yright = yright_out):</span> need at least two non-NA values to interpolate</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Smooth the completed tracking of the 405 kyr eccentricity cycle in the wavelet spectra</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mag_track_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="loess_auto.html">loess_auto</a></span><span class="op">(</span>time_series <span class="op">=</span> <span class="va">mag_track_complete</span>,</span></span>
<span class="r-in"><span>genplot <span class="op">=</span> <span class="cn">FALSE</span>, print_span <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'mag_track_complete' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#extract the spectral power of the 405 kyr eccentricity cycle</span></span></span>
<span class="r-in"><span><span class="va">mag_power</span> <span class="op">&lt;-</span> <span class="fu">extract_power</span><span class="op">(</span></span></span>
<span class="r-in"><span>tracked_period_curve <span class="op">=</span> <span class="va">mag_track_complete</span>,</span></span>
<span class="r-in"><span>scalogram <span class="op">=</span> <span class="va">mag_wt</span>,</span></span>
<span class="r-in"><span>period_up <span class="op">=</span> <span class="fl">1.2</span>,</span></span>
<span class="r-in"><span>period_down <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>tracked_cycle_period <span class="op">=</span> <span class="fl">405</span>,</span></span>
<span class="r-in"><span>extract_cycle_power <span class="op">=</span> <span class="fl">405</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'mag_track_complete' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michiel Arts.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

