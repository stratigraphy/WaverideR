<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extract a signal using standard deviation — extract_signal_standard_deviation • WaverideR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Extract a signal using standard deviation — extract_signal_standard_deviation"><meta property="og:description" content="Extract signal from a
wavelet spectra in the depth domain using a the standard deviation of the omega (number of cycles)
as boundaries. The uncertainty is based on the Gabor uncertainty principle applied to the
continuous wavelet transform using a Morlet wavelet. The calculated uncertainty is the underlying
analytical uncertainty which is the result of applying the Gabor uncertainty principle to the
continuous wavelet transform using a Morlet wavelet."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WaverideR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stratigraphy/WaverideR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract a signal using standard deviation</h1>
    <small class="dont-index">Source: <a href="https://github.com/stratigraphy/WaverideR/blob/HEAD/R/extract_signal_standard_deviation.R" class="external-link"><code>R/extract_signal_standard_deviation.R</code></a></small>
    <div class="hidden name"><code>extract_signal_standard_deviation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extract signal from a
wavelet spectra in the depth domain using a the standard deviation of the omega (number of cycles)
as boundaries. The uncertainty is based on the Gabor uncertainty principle applied to the
continuous wavelet transform using a Morlet wavelet. The calculated uncertainty is the underlying
analytical uncertainty which is the result of applying the Gabor uncertainty principle to the
continuous wavelet transform using a Morlet wavelet.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extract_signal_standard_deviation</span><span class="op">(</span></span>
<span>  wavelet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tracked_cycle_curve <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  multi <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  extract_cycle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tracked_cycle_period <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_mean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tune <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  genplot_uncertainty_wt <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  genplot_extracted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keep_editable <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  palette_name <span class="op">=</span> <span class="st">"rainbow"</span>,</span>
<span>  color_brewer <span class="op">=</span> <span class="st">"grDevices"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-wavelet">wavelet<a class="anchor" aria-label="anchor" href="#arg-wavelet"></a></dt>
<dd><p>Wavelet object created using the <code><a href="analyze_wavelet.html">analyze_wavelet</a></code> function.</p></dd>


<dt id="arg-tracked-cycle-curve">tracked_cycle_curve<a class="anchor" aria-label="anchor" href="#arg-tracked-cycle-curve"></a></dt>
<dd><p>Curve of the cycle tracked using the
<code><a href="track_period_wavelet.html">track_period_wavelet</a></code> function. Any input (matrix or data frame)
 in which the first column is depth or time and the second column is period should work.</p></dd>


<dt id="arg-multi">multi<a class="anchor" aria-label="anchor" href="#arg-multi"></a></dt>
<dd><p>multiple of the standard deviation to be used as boundaries for the cycle extraction
<code>Default=1</code>.</p></dd>


<dt id="arg-extract-cycle">extract_cycle<a class="anchor" aria-label="anchor" href="#arg-extract-cycle"></a></dt>
<dd><p>Period of the cycle to be extracted.</p></dd>


<dt id="arg-tracked-cycle-period">tracked_cycle_period<a class="anchor" aria-label="anchor" href="#arg-tracked-cycle-period"></a></dt>
<dd><p>Period of the tracked cycle.</p></dd>


<dt id="arg-add-mean">add_mean<a class="anchor" aria-label="anchor" href="#arg-add-mean"></a></dt>
<dd><p>Add mean to the extracted cycle <code>Default=TRUE</code>.</p></dd>


<dt id="arg-tune">tune<a class="anchor" aria-label="anchor" href="#arg-tune"></a></dt>
<dd><p>Tune data set using the <code>Default=tracked_cycle_curve</code> curve <code>Default=FALSE</code>.</p></dd>


<dt id="arg-genplot-uncertainty-wt">genplot_uncertainty_wt<a class="anchor" aria-label="anchor" href="#arg-genplot-uncertainty-wt"></a></dt>
<dd><p>Generate a wavelet spectra plot with the tracked curve and its
analytical uncertainty based the Gabor uncertainty principle applied
continuous wavelet transform using a Morlet wavelet on superimposed on top of it.
In the plot the red curve and blue curves are the upper and lower bounds
based on the <code>multi</code> parameter which x-times the standard deviation of uncertainty.
The black curve is the <code>Default=FALSE</code> curve.</p></dd>


<dt id="arg-genplot-extracted">genplot_extracted<a class="anchor" aria-label="anchor" href="#arg-genplot-extracted"></a></dt>
<dd><p>Generates a plot with the data set and
the extracted cycle on top <code>Default=FALSE</code> of it.</p></dd>


<dt id="arg-keep-editable">keep_editable<a class="anchor" aria-label="anchor" href="#arg-keep-editable"></a></dt>
<dd><p>Keep option to add extra features after plotting  <code>Default=FALSE</code></p></dd>


<dt id="arg-palette-name">palette_name<a class="anchor" aria-label="anchor" href="#arg-palette-name"></a></dt>
<dd><p>Name of the color palette which is used for plotting.
The color palettes than can be chosen depends on which the R package is specified in
the color_brewer parameter. The included R packages from which palettes can be chosen
from are; the 'RColorBrewer', 'grDevices', 'ColorRamps' and 'Viridis' R packages.
There are many options to choose from so please
read the documentation of these packages <code>Default=rainbow</code>.
The R package 'viridis' has the color palette options: “magma”, “plasma”,
“inferno”, “viridis”, “mako”, and “rocket”  and “turbo”
To see the color palette options of the The R pacakge 'RColorBrewer' run
the RColorBrewer::brewer.pal.info() function
The R package 'colorRamps' has the color palette options:"blue2green",
"blue2green2red", "blue2red",    "blue2yellow", "colorRamps",    "cyan2yellow",
"green2red", "magenta2green", "matlab.like", "matlab.like2" and    "ygobb"
The R package 'grDevices' has the built in  palette options:"rainbow",
"heat.colors", "terrain.colors","topo.colors" and "cm.colors"
To see even more color palette options of the The R pacakge 'grDevices' run
the grDevices::hcl.pals() function</p></dd>


<dt id="arg-color-brewer">color_brewer<a class="anchor" aria-label="anchor" href="#arg-color-brewer"></a></dt>
<dd><p>Name of the R package from which the color palette is chosen from.
The included R packages from which palettes can be chosen
are; the RColorBrewer, grDevices, ColorRamps and Viridis R packages.
There are many options to choose from so please
read the documentation of these packages. "<code>Default=grDevices</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Signal extracted from the wavelet spectra.
Output is a matrix with the first column being depth/time
and the second column is the astronomical cycle extracted from the proxy record</p>
<p>If <code>genplot_uncertainty_wt=TRUE</code> then a wavelet spectra will be plotted
with the uncertainty superimposed on top of it. In the plot the red curve and
blue curves are the upper and lower bounds
based on the <code>multi</code> parameter.The black curve is the <code>Default=tracked_cycle_curve</code> curve.
If <code>genplot_extracted=TRUE</code> plot with the data set and
the extracted cycle on top of it will be plotted.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Angi Roesch and Harald Schmidbauer (2018). WaveletComp: Computational
Wavelet Analysis. R package version 1.1.
<a href="https://CRAN.R-project.org/package=WaveletComp" class="external-link">https://CRAN.R-project.org/package=WaveletComp</a></p>
<p>Gouhier TC, Grinsted A, Simko V (2021). R package biwavelet: Conduct Univariate and Bivariate Wavelet Analyses. (Version 0.20.21),
<a href="https://github.com/tgouhier/biwavelet" class="external-link">https://github.com/tgouhier/biwavelet</a></p>
<p>Torrence, C., and G. P. Compo. 1998. A Practical Guide to Wavelet Analysis.
Bulletin of the American Meteorological Society 79:61-78.
<a href="https://paos.colorado.edu/research/wavelets/bams_79_01_0061.pdf" class="external-link">https://paos.colorado.edu/research/wavelets/bams_79_01_0061.pdf</a></p>
<p>Gabor, Dennis. "Theory of communication. Part 1: The analysis of information."
Journal of the Institution of Electrical Engineers-part III: radio and
communication engineering 93, no. 26 (1946): 429-441.<a href="http://genesis.eecg.toronto.edu/gabor1946.pdf" class="external-link">http://genesis.eecg.toronto.edu/gabor1946.pdf</a></p>
<p>Russell, Brian, and Jiajun Han. "Jean Morlet and the continuous wavelet transform.
" CREWES Res. Rep 28 (2016): 115. <a href="https://www.crewes.org/Documents/ResearchReports/2016/CRR201668.pdf" class="external-link">https://www.crewes.org/Documents/ResearchReports/2016/CRR201668.pdf</a></p>

<p>Morlet, Jean, Georges Arens, Eliane Fourgeau, and Dominique Glard.
"Wave propagation and sampling theory—Part I: Complex signal and scattering in multilayered media.
" Geophysics 47, no. 2 (1982): 203-221.</p>
<p>J. Morlet, G. Arens, E. Fourgeau, D. Giard;
Wave propagation and sampling theory; Part II, Sampling theory and complex waves.
Geophysics 1982 47 (2): 222–236.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Code based on the reconstruct function of the 'WaveletComp' R package
which is based on the wavelet 'MATLAB' code written by Christopher Torrence and Gibert P. Compo (1998).
The assignment of the standard deviation of the uncertainty of the wavelet
is based on the work of Gabor (1946) and Russell et al., (2016)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">#Extract the 405 kyr eccentricity cycle from the magnetic susceptibility</span></span></span>
<span class="r-in"><span><span class="co">#record of the Sullivan core of Pas et al., (2018) and use the Gabor</span></span></span>
<span class="r-in"><span><span class="co"># uncertainty principle to define the mathematical uncertainty of the</span></span></span>
<span class="r-in"><span><span class="co"># analysis and use a factor of that standard deviation to define</span></span></span>
<span class="r-in"><span><span class="co"># boundaries</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># perform the CWT</span></span></span>
<span class="r-in"><span><span class="va">mag_wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="analyze_wavelet.html">analyze_wavelet</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mag</span>,</span></span>
<span class="r-in"><span>dj <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>lowerPeriod <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>upperPeriod <span class="op">=</span> <span class="fl">254</span>,</span></span>
<span class="r-in"><span>verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>omega_nr <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Track the 405 kyr eccentricity cycle in a wavelet spectra</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#mag_track &lt;- track_period_wavelet(astro_cycle = 405,</span></span></span>
<span class="r-in"><span><span class="co">#                                   wavelet=mag_wt,</span></span></span>
<span class="r-in"><span><span class="co">#                                   n.levels = 100,</span></span></span>
<span class="r-in"><span><span class="co">#                                   periodlab = "Period (metres)",</span></span></span>
<span class="r-in"><span><span class="co">#                                   x_lab = "depth (metres)",</span></span></span>
<span class="r-in"><span><span class="co">#                                   palette_name="rainbow",</span></span></span>
<span class="r-in"><span><span class="co">#                                   color_brewer="grDevices")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Instead of tracking, the tracked solution data set mag_track_solution is used</span></span></span>
<span class="r-in"><span><span class="va">mag_track</span> <span class="op">&lt;-</span> <span class="va">mag_track_solution</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mag_track_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="completed_series.html">completed_series</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  wavelet <span class="op">=</span> <span class="va">mag_wt</span>,</span></span>
<span class="r-in"><span>  tracked_curve <span class="op">=</span> <span class="va">mag_track</span>,</span></span>
<span class="r-in"><span>  period_up <span class="op">=</span> <span class="fl">1.2</span>,</span></span>
<span class="r-in"><span>  period_down <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>  extrapolate <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  genplot <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># smooth the tracking of the 405 kyr eccentricity cycle</span></span></span>
<span class="r-in"><span><span class="va">mag_track_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="loess_auto.html">loess_auto</a></span><span class="op">(</span>time_series <span class="op">=</span> <span class="va">mag_track_complete</span>,</span></span>
<span class="r-in"><span>genplot <span class="op">=</span> <span class="cn">FALSE</span>, print_span <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># extract the 405 kyr eccentricity cycle from the wavelet spectrum and use</span></span></span>
<span class="r-in"><span><span class="co"># the Gabor uncertainty principle to define the mathematical uncertainty of</span></span></span>
<span class="r-in"><span><span class="co"># the analysis and use a multiple of the derived standard deviation to define boundaries</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mag_405_ecc</span> <span class="op">&lt;-</span> <span class="fu">extract_signal_standard_deviation</span><span class="op">(</span></span></span>
<span class="r-in"><span>wavelet <span class="op">=</span> <span class="va">mag_wt</span>,</span></span>
<span class="r-in"><span>tracked_cycle_curve <span class="op">=</span> <span class="va">mag_track_complete</span>,</span></span>
<span class="r-in"><span>multi <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>extract_cycle <span class="op">=</span> <span class="fl">405</span>,</span></span>
<span class="r-in"><span>tracked_cycle_period <span class="op">=</span> <span class="fl">405</span>,</span></span>
<span class="r-in"><span>add_mean <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>tune <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>genplot_uncertainty_wt <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>genplot_extracted <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>keep_editable<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>palette_name<span class="op">=</span><span class="st">"rainbow"</span>,</span></span>
<span class="r-in"><span>color_brewer<span class="op">=</span><span class="st">"grDevices"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michiel Arts.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

