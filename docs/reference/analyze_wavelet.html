<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Conduct the continuous wavelet transform on a time series/signal — analyze_wavelet • WaverideR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Conduct the continuous wavelet transform on a time series/signal — analyze_wavelet"><meta property="og:description" content="Compute the continuous wavelet transform (CWT) using a Morlet wavelet"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WaverideR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stratigraphy/WaverideR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Conduct the continuous wavelet transform on a time series/signal</h1>
    <small class="dont-index">Source: <a href="https://github.com/stratigraphy/WaverideR/blob/HEAD/R/analyze_wavelet.R" class="external-link"><code>R/analyze_wavelet.R</code></a></small>
    <div class="hidden name"><code>analyze_wavelet.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the continuous wavelet transform (CWT) using a Morlet wavelet</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">analyze_wavelet</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dj <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span>,</span>
<span>  lowerPeriod <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  upperPeriod <span class="op">=</span> <span class="fl">1024</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  omega_nr <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  pval <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_simulations <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  run_multicore <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Input data, should be a matrix or data frame in which
the first column is depth or time and the second column is proxy record.</p></dd>


<dt id="arg-dj">dj<a class="anchor" aria-label="anchor" href="#arg-dj"></a></dt>
<dd><p>Spacing between successive scales. The CWT analyses analyses the signal using successive periods
which increase by the power of 2 (e.g.2^0=1,2^1=2,2^2=4,2^3=8,2^4=16). To have more resolution
in-between these steps the dj parameter exists, the dj parameter specifies how many extra steps/spacing in-between
the power of 2 scaled CWT is added. The amount of steps is 1/x with a higher x indicating a smaller spacing.
Increasing the increases the computational time of the CWT <code>Default=1/200</code>.</p></dd>


<dt id="arg-lowerperiod">lowerPeriod<a class="anchor" aria-label="anchor" href="#arg-lowerperiod"></a></dt>
<dd><p>Lowest period to be analyzed <code>Default=2</code>.
The CWT analyses the signal starting from the lowerPeriod to the upperPeriod so the proper selection these
parameters allows to analyze the signal for a specific range of cycles.
scaling is done using power 2 so for the best plotting results select a value to the power or 2.</p></dd>


<dt id="arg-upperperiod">upperPeriod<a class="anchor" aria-label="anchor" href="#arg-upperperiod"></a></dt>
<dd><p>Upper period to be analyzed <code>Default=1024</code>.
The CWT analyses the signal starting from the lowerPeriod to the upperPeriod so the proper selection these
parameters allows to analyze the signal for a specific range of cycles.
 scaling is done using power 2 so for the best plotting results select a value to the power or 2.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Print text <code>Default=FALSE</code>.</p></dd>


<dt id="arg-omega-nr">omega_nr<a class="anchor" aria-label="anchor" href="#arg-omega-nr"></a></dt>
<dd><p>Number of cycles contained within the Morlet wavelet</p></dd>


<dt id="arg-pval">pval<a class="anchor" aria-label="anchor" href="#arg-pval"></a></dt>
<dd><p>calculate the P-value  <code>Default=FALSE</code>. The p-value is based on
Monte Carlo modelling runs on surrogate data generated based on autocorrelated noise (red noise) the calculated using a windowed
(the window is half the size of the data set) temporal autocorrelation
and on shuffling the data set resulting in a random data sets which has similar spectral characteristics
to the original data set.The shuffling of the data set creates white noise which ensures that high amplitude high frequency/short
period cycles do not result in statistical significant peaks. The part of the data generated using the  autocorrelated noise (red noise)
based on the windowed  (the window is half the size of the data set) temporal autocorrelation represent a spectral signature similar to
to that of the original data. The original data might include spectral peaks which are the result of astronomical
forcing. The result is that the spectral power profile is biased towards rejecting the 0-hypothesis (e.g. no astronomical forcing).
By combining the shuffling of the data set with autocorrelated noise a surrogate data set is created which rejects
high amplitude high frequency/short period cycles and a reduced biased towards towards rejecting the 0-hypothesis if the data was
solely the result of autocorrelated noise</p></dd>


<dt id="arg-n-simulations">n_simulations<a class="anchor" aria-label="anchor" href="#arg-n-simulations"></a></dt>
<dd><p>Number of simulation to be ran to generate the p-value</p></dd>


<dt id="arg-run-multicore">run_multicore<a class="anchor" aria-label="anchor" href="#arg-run-multicore"></a></dt>
<dd><p>Run p-value calculation with one core or multiple cores</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The output is a list (wavelet object) which contain 20 objects which are the result of the continuous wavelet transform (CWT).
Object 1: Wave - Wave values of the wavelet
Object 2: Phase - Phase of the wavelet
Object 3: Ampl - Amplitude values of the wavelet
Object 4: Power - Power values of the wavelet
Object 5: dt - Step size
Object 6: dj - Scale size
Object 7: Power.avg  - Average power values
Object 8: Period - Period values
Object 9: Scale - Scale value
Object 10: coi.1 - Cone of influence values 1
Object 11: coi.2 - Cone of influence values 2
Object 12: nc - Number of columns
Object 13: nr - Number of rows
Object 14: axis.1 - axis values 1
Object 15: axis.2 - axis values 2
Object 16: omega_nr - Number of cycles in the wavelet
Object 17: x - x values of the data set
Object 18: y - y values of the data set
Object 19: average p value of the spectral power
Object 20: p value of spectral power</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Angi Roesch and Harald Schmidbauer (2018). WaveletComp: Computational
Wavelet Analysis. R package version 1.1.
<a href="https://CRAN.R-project.org/package=WaveletComp" class="external-link">https://CRAN.R-project.org/package=WaveletComp</a></p>
<p>Gouhier TC, Grinsted A, Simko V (2021). R package biwavelet: Conduct Univariate and Bivariate Wavelet Analyses. (Version 0.20.21),
<a href="https://github.com/tgouhier/biwavelet" class="external-link">https://github.com/tgouhier/biwavelet</a></p>
<p>Torrence, C., and G. P. Compo. 1998. A Practical Guide to Wavelet Analysis.
Bulletin of the American Meteorological Society 79:61-78.
<a href="https://paos.colorado.edu/research/wavelets/bams_79_01_0061.pdf" class="external-link">https://paos.colorado.edu/research/wavelets/bams_79_01_0061.pdf</a></p>
<p>Morlet, Jean, Georges Arens, Eliane Fourgeau, and Dominique Glard.
"Wave propagation and sampling theory—Part I: Complex signal and scattering in multilayered media.
" Geophysics 47, no. 2 (1982): 203-221.</p>
<p>J. Morlet, G. Arens, E. Fourgeau, D. Giard;
Wave propagation and sampling theory; Part II, Sampling theory and complex waves.
 Geophysics 1982 47 (2): 222–236.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Code based on on the "WaveletComp" function of the 'WaveletComp' R package
and "wt" function of the 'biwavelet' R package which are based on the
wavelet MATLAB code written by Christopher Torrence and Gibert P. Compo.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">#Example 1. Using the Total Solar Irradiance data set of Steinhilver et al., (2012)</span></span></span>
<span class="r-in"><span><span class="va">TSI_wt</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span> <span class="fu">analyze_wavelet</span><span class="op">(</span></span></span>
<span class="r-in"><span>   data <span class="op">=</span> <span class="va">TSI</span>,</span></span>
<span class="r-in"><span>   dj <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">200</span>,</span></span>
<span class="r-in"><span>   lowerPeriod <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>   upperPeriod <span class="op">=</span> <span class="fl">8192</span>,</span></span>
<span class="r-in"><span>   verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   omega_nr <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>   pval<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   n_simulations<span class="op">=</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>   run_multicore <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Example 2. Using the magnetic susceptibility data set of Pas et al., (2018)</span></span></span>
<span class="r-in"><span><span class="va">mag_wt</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="fu">analyze_wavelet</span><span class="op">(</span></span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="va">mag</span>,</span></span>
<span class="r-in"><span>dj <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>lowerPeriod <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>upperPeriod <span class="op">=</span> <span class="fl">254</span>,</span></span>
<span class="r-in"><span>verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>omega_nr <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>pval<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>n_simulations<span class="op">=</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>run_multicore <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Example 3. Using the greyscale data set of Zeeden et al., (2013)</span></span></span>
<span class="r-in"><span><span class="va">grey_wt</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span> <span class="fu">analyze_wavelet</span><span class="op">(</span></span></span>
<span class="r-in"><span>   data <span class="op">=</span> <span class="va">grey</span>,</span></span>
<span class="r-in"><span>   dj <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">200</span>,</span></span>
<span class="r-in"><span>   lowerPeriod <span class="op">=</span> <span class="fl">0.02</span>,</span></span>
<span class="r-in"><span>   upperPeriod <span class="op">=</span> <span class="fl">256</span>,</span></span>
<span class="r-in"><span>   verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   omega_nr <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>   pval<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   n_simulations<span class="op">=</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>   run_multicore <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michiel Arts.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

