<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Conduct the superlet transform on a time series or signal — analyze_superlet • WaverideR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Conduct the superlet transform on a time series or signal — analyze_superlet"><meta property="og:description" content="Compute the superlet transform using a complex Morlet wavelet following
the approach of Moca et al. (2021). The superlet transform increases
time frequency resolution by combining multiple wavelet orders at each
frequency. Both the frequency sampling and the scaling of superlet order
with frequency can be explicitly controlled."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WaverideR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stratigraphy/WaverideR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Conduct the superlet transform on a time series or signal</h1>
    <small class="dont-index">Source: <a href="https://github.com/stratigraphy/WaverideR/blob/HEAD/R/analyze_superlet.R" class="external-link"><code>R/analyze_superlet.R</code></a></small>
    <div class="hidden name"><code>analyze_superlet.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the superlet transform using a complex Morlet wavelet following
the approach of Moca et al. (2021). The superlet transform increases
time frequency resolution by combining multiple wavelet orders at each
frequency. Both the frequency sampling and the scaling of superlet order
with frequency can be explicitly controlled.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">analyze_superlet</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">upperPeriod</span>,</span>
<span>  <span class="va">lowerPeriod</span>,</span>
<span>  <span class="va">Nf</span>,</span>
<span>  <span class="va">c1</span>,</span>
<span>  o <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mult <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  order_scaling <span class="op">=</span> <span class="st">"log2"</span>,</span>
<span>  order_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Input data as a matrix or data frame. The first column must
represent depth or time, and the second column the signal or proxy record.</p></dd>


<dt id="arg-upperperiod">upperPeriod<a class="anchor" aria-label="anchor" href="#arg-upperperiod"></a></dt>
<dd><p>Maximum period to be analysed. Controls the lowest
analysed frequency.</p></dd>


<dt id="arg-lowerperiod">lowerPeriod<a class="anchor" aria-label="anchor" href="#arg-lowerperiod"></a></dt>
<dd><p>Minimum period to be analysed. Controls the highest
analysed frequency.</p></dd>


<dt id="arg-nf">Nf<a class="anchor" aria-label="anchor" href="#arg-nf"></a></dt>
<dd><p>Number of frequencies used to construct the superlet spectrum.</p></dd>


<dt id="arg-c-">c1<a class="anchor" aria-label="anchor" href="#arg-c-"></a></dt>
<dd><p>Base number of cycles of the Morlet wavelet. Acts as the
fundamental wavelet width.</p></dd>


<dt id="arg-o">o<a class="anchor" aria-label="anchor" href="#arg-o"></a></dt>
<dd><p>numeric vector of length two defining the minimum and
maximum superlet order.</p></dd>


<dt id="arg-mult">mult<a class="anchor" aria-label="anchor" href="#arg-mult"></a></dt>
<dd><p>Logical. If TRUE, the number of cycles increases
multiplicatively with superlet order. If FALSE, cycles increase
additively.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If TRUE, print progress and interpolation
information.</p></dd>


<dt id="arg-freq-scale">freq.scale<a class="anchor" aria-label="anchor" href="#arg-freq-scale"></a></dt>
<dd><p>Character string defining how frequencies are sampled.
One of <code>"log2"</code>, <code>"linear"</code>, or <code>"sqrt"</code>.
Default is <code>"log2"</code>, following the original superlet formulation.</p></dd>


<dt id="arg-scaling">scaling<a class="anchor" aria-label="anchor" href="#arg-scaling"></a></dt>
<dd><p>Character string defining how the number of wavelet
cycles varies with scale. One of
<code>"log2"</code>, <code>"linear"</code>, <code>"sqrt"</code>, <code>"quadratic"</code>,
or <code>"power"</code>.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Numeric. Exponent used when <code>scaling = "power"</code>.
Values greater than one emphasize high frequency sharpening, whereas
values smaller than one emphasize low frequency sharpening.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with class <code>"analyze.superlet"</code> containing
Power: time frequency power spectrum
dt: sampling interval after interpolation
dj: number of frequencies
Power.avg: average spectral power
Period: physical periods corresponding to frequencies
nc: number of columns in the input data
nr: number of frequency levels
axis.1: x axis values (time or depth)
axis.2: y axis values (log2 scaled periods)
c1: base number of wavelet cycles
o: numeric vector of length two defining the minimum and
maximum superlet order. If NULL, all frequencies are analysed using
order one.
freq.scale: scaling of the frequencies
order.mode: order.mode ("none", "log2", "linear", "sqrt", "power")
x: interpolated x values
y: interpolated signal values</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Moca, V. V., Bârzan, H., Nagy-Dăbâcan, A., and Mureșan, R. C. (2021).
Time frequency super resolution with superlets.
Nature Communications, 12, 337.
<a href="https://doi.org/10.1038/s41467-020-20539-9" class="external-link">https://doi.org/10.1038/s41467-020-20539-9</a></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Adapted from MATLAB implementations by V. V. Moca et al. (2021)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Example 1. Using the Total Solar Irradiance data set of Steinhilber et al. (2012)</span></span></span>
<span class="r-in"><span><span class="va">TSI_sl</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">analyze_superlet</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">TSI</span>,</span></span>
<span class="r-in"><span>    upperPeriod <span class="op">=</span> <span class="fl">8192</span>,</span></span>
<span class="r-in"><span>    lowerPeriod <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>    Nf <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>    c1 <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    o <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    mult <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    order_scaling <span class="op">=</span> <span class="st">"log2"</span>,</span></span>
<span class="r-in"><span>    order_alpha <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 2. Using the magnetic susceptibility data set of Pas et al. (2018)</span></span></span>
<span class="r-in"><span><span class="va">mag_sl</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">analyze_superlet</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">mag</span>,</span></span>
<span class="r-in"><span>    upperPeriod <span class="op">=</span> <span class="fl">254</span>,</span></span>
<span class="r-in"><span>    lowerPeriod <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>    Nf <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>    c1 <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    o <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    mult <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    order_scaling <span class="op">=</span> <span class="st">"log2"</span>,</span></span>
<span class="r-in"><span>    order_alpha <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 3. Using the greyscale data set of Zeeden et al. (2013)</span></span></span>
<span class="r-in"><span><span class="va">grey_sl</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">analyze_superlet</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">grey</span>,</span></span>
<span class="r-in"><span>    upperPeriod <span class="op">=</span> <span class="fl">256</span>,</span></span>
<span class="r-in"><span>    lowerPeriod <span class="op">=</span> <span class="fl">0.02</span>,</span></span>
<span class="r-in"><span>    Nf <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>    c1 <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    o <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    mult <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    order_scaling <span class="op">=</span> <span class="st">"log2"</span>,</span></span>
<span class="r-in"><span>    order_alpha <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michiel Arts.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

