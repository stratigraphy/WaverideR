<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit linear models to spectral peaks extracted from the wavelet spectra to astronomical cycles multiplied by sedimentation rate x — flmw • WaverideR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit linear models to spectral peaks extracted from the wavelet spectra to astronomical cycles multiplied by sedimentation rate x — flmw"><meta property="og:description" content="The flmw function is used calculate the linear correlation
for a list of astronomical cycles transformed using a range of sedimentation rates and then compared
to spectral peaks of a wavelet spectra"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WaverideR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stratigraphy/WaverideR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit linear models to spectral peaks extracted from the wavelet spectra to astronomical cycles multiplied by sedimentation rate x</h1>
    <small class="dont-index">Source: <a href="https://github.com/stratigraphy/WaverideR/blob/HEAD/R/flmw.R" class="external-link"><code>R/flmw.R</code></a></small>
    <div class="hidden name"><code>flmw.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>flmw</code> function is used calculate the linear correlation
for a list of astronomical cycles transformed using a range of sedimentation rates and then compared
to spectral peaks of a wavelet spectra</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">flmw</span><span class="op">(</span></span>
<span>  wavelet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sedrate_low <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sedrate_high <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spacing <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cycles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  x_lab <span class="op">=</span> <span class="st">"depth"</span>,</span>
<span>  y_lab <span class="op">=</span> <span class="st">"sedrate"</span>,</span>
<span>  run_random <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rand_simulations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  run_multicore <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  genplot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  palette_name <span class="op">=</span> <span class="st">"rainbow"</span>,</span>
<span>  color_brewer <span class="op">=</span> <span class="st">"grDevices"</span>,</span>
<span>  plot_res <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  keep_editable <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-wavelet">wavelet<a class="anchor" aria-label="anchor" href="#arg-wavelet"></a></dt>
<dd><p>Wavelet object created using the <code><a href="analyze_wavelet.html">analyze_wavelet</a></code> function</p></dd>


<dt id="arg-sedrate-low">sedrate_low<a class="anchor" aria-label="anchor" href="#arg-sedrate-low"></a></dt>
<dd><p>Minimum sedimentation rate (cm/kyr)for which the sum of maximum spectral power is calculated for.</p></dd>


<dt id="arg-sedrate-high">sedrate_high<a class="anchor" aria-label="anchor" href="#arg-sedrate-high"></a></dt>
<dd><p>Maximum sedimentation rate (cm/kyr) for which the sum of maximum spectral power is calculated  for.</p></dd>


<dt id="arg-spacing">spacing<a class="anchor" aria-label="anchor" href="#arg-spacing"></a></dt>
<dd><p>Spacing (cm/kyr) between sedimentation rates</p></dd>


<dt id="arg-cycles">cycles<a class="anchor" aria-label="anchor" href="#arg-cycles"></a></dt>
<dd><p>Astronomical cycles (in kyr) for which the combined sum of maximum spectral power is calculated for</p></dd>


<dt id="arg-x-lab">x_lab<a class="anchor" aria-label="anchor" href="#arg-x-lab"></a></dt>
<dd><p>label for the y-axis <code>Default="depth"</code></p></dd>


<dt id="arg-y-lab">y_lab<a class="anchor" aria-label="anchor" href="#arg-y-lab"></a></dt>
<dd><p>label for the y-axis <code>Default="sedrate"</code></p></dd>


<dt id="arg-run-random">run_random<a class="anchor" aria-label="anchor" href="#arg-run-random"></a></dt>
<dd><p>run multiple simulation to calculate percentile against the 0 hypothesis</p></dd>


<dt id="arg-rand-simulations">rand_simulations<a class="anchor" aria-label="anchor" href="#arg-rand-simulations"></a></dt>
<dd><p>nr of simulations to calculate percentile against the 0 hypothesis</p></dd>


<dt id="arg-run-multicore">run_multicore<a class="anchor" aria-label="anchor" href="#arg-run-multicore"></a></dt>
<dd><p>run simulation using multiple cores <code>Default=FALSE</code>
the simulation is run at x-2 cores to allow the 2 remaining processes to run background processes</p></dd>


<dt id="arg-genplot">genplot<a class="anchor" aria-label="anchor" href="#arg-genplot"></a></dt>
<dd><p>Generate plot <code>Default="FALSE"</code></p></dd>


<dt id="arg-palette-name">palette_name<a class="anchor" aria-label="anchor" href="#arg-palette-name"></a></dt>
<dd><p>Name of the color palette which is used for plotting.
The color palettes than can be chosen depends on which the R package is specified in
the color_brewer parameter. The included R packages from which palettes can be chosen
from are; the 'RColorBrewer', 'grDevices', 'ColorRamps' and 'Viridis' R packages.
There are many options to choose from so please
read the documentation of these packages <code>Default=rainbow</code>.
The R package 'viridis' has the color palette options: “magma”, “plasma”,
“inferno”, “viridis”, “mako”, and “rocket”  and “turbo”
To see the color palette options of the The R pacakge 'RColorBrewer' run
the RColorBrewer::brewer.pal.info() function
The R package 'colorRamps' has the color palette options:"blue2green",
"blue2green2red", "blue2red",    "blue2yellow", "colorRamps",    "cyan2yellow",
"green2red", "magenta2green", "matlab.like", "matlab.like2" and    "ygobb"
The R package 'grDevices' has the built in  palette options:"rainbow",
"heat.colors", "terrain.colors","topo.colors" and "cm.colors"
To see even more color palette options of the The R pacakge 'grDevices' run
the grDevices::hcl.pals() function</p></dd>


<dt id="arg-color-brewer">color_brewer<a class="anchor" aria-label="anchor" href="#arg-color-brewer"></a></dt>
<dd><p>Name of the R package from which the color palette is chosen from.
The included R packages from which palettes can be chosen
are; the RColorBrewer, grDevices, ColorRamps and Viridis R packages.
There are many options to choose from so please
read the documentation of these packages. "<code>Default=grDevices</code></p></dd>


<dt id="arg-plot-res">plot_res<a class="anchor" aria-label="anchor" href="#arg-plot-res"></a></dt>
<dd><p>options 1-8 option 1: slope coefficient, option 2: r squared,
option 3: nr of components, option 4: difference to the  origin , option 5: slope coefficient percentile
option 6: r squared percentile, option 7: nr of components percentile,
option 8: difference to the origin percentile <code>Default=2</code></p></dd>


<dt id="arg-keep-editable">keep_editable<a class="anchor" aria-label="anchor" href="#arg-keep-editable"></a></dt>
<dd><p>Keep option to add extra features after plotting  <code>Default=FALSE</code></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Print text <code>Default=FALSE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a list which contains 10 elements
element 1: slope coefficient
element 2: r squared
element 3: nr of components
element 4: difference to the origin
element 5: slope coefficient percentile
element 6: r squared percentile
element 7: nr of components percentile,
element 8: difference to the origin percentile
element 9: y-axis values of the matrices which is sedimentation rate
element 10: x-axis values of the matrices which is depth</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Routines for astrochronologic testing, astronomical time scale construction, and
time series analysis &lt;doi:10.1016/j.earscirev.2018.11.015&gt;</p>
<p>Acycle: Time-series analysis software for paleoclimate research and education,
Mingsong Li, Linda Hinnov, Lee Kump,
Computers &amp; Geosciences,Volume 127,2019,Pages 12-22,ISSN 0098-3004,
&lt;doi:10.1016/j.cageo.2019.02.011&gt;</p>
<p>Tracking variable sedimentation rates and astronomical forcing in Phanerozoic paleoclimate proxy series with evolutionary correlation coefficients and hypothesis testing,
Mingsong Li, Lee R. Kump, Linda A. Hinnov, Michael E. Mann,
Earth and Planetary Science Letters,Volume 501,
T2018,Pages 165-179,ISSN 0012-821X,&lt;doi:10.1016/j.epsl.2018.08.041&gt;</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Based on the <a href="https://rdrr.io/pkg/astrochron/man/eAsm.html" class="external-link">eAsm</a> function of the 'astrochron' R package and the 'eCOCO' and 'COCO' function of the 'Acycle' software</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">#estimate sedimentation rate for the magnetic susceptibility record</span></span></span>
<span class="r-in"><span><span class="co"># of the Sullivan core of Pas et al., (2018).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mag_wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="analyze_wavelet.html">analyze_wavelet</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mag</span>,</span></span>
<span class="r-in"><span>dj <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>lowerPeriod <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>upperPeriod <span class="op">=</span> <span class="fl">254</span>,</span></span>
<span class="r-in"><span>verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>omega_nr <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sedrates</span> <span class="op">&lt;-</span> <span class="fu">flmw</span><span class="op">(</span>wavelet <span class="op">=</span> <span class="va">mag_wt</span>,</span></span>
<span class="r-in"><span>    sedrate_low <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>    sedrate_high <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>    spacing <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>    cycles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2376</span>,<span class="fl">1600</span>,<span class="fl">1180</span>,<span class="fl">696</span>,<span class="fl">406</span>,<span class="fl">110</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x_lab <span class="op">=</span> <span class="st">"depth"</span>,</span></span>
<span class="r-in"><span>    y_lab <span class="op">=</span> <span class="st">"sedrate"</span>,</span></span>
<span class="r-in"><span>    run_random <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    rand_simulations <span class="op">=</span> <span class="fl">50</span>, <span class="co"># increase to get better constrainted resutls</span></span></span>
<span class="r-in"><span>    run_multicore <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    genplot <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    palette_name <span class="op">=</span> <span class="st">"rainbow"</span>,</span></span>
<span class="r-in"><span>    color_brewer <span class="op">=</span> <span class="st">"grDevices"</span>,</span></span>
<span class="r-in"><span>    plot_res <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    keep_editable<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michiel Arts.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

