<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Track the period of a cycle in a wavelet or superlet scalogram — track_period • WaverideR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Track the period of a cycle in a wavelet or superlet scalogram — track_period"><meta property="og:description" content="Interactively select points in a wavelet or superlet power spectrum
to trace the evolution of a cycle with changing period.
The track_period function plots a time-frequency spectrum
in which spectral peaks can be selected to track a ridge through time
or depth. This allows the user to follow a cycle whose period varies
along the record.
Tracking points are selected interactively and displayed as white dots.
Previously selected points can be deselected by clicking them again,
after which they are shown as red dots. Because points may be closely
spaced, de-selection can be difficult. In such cases,
delpts_tracked_period_wt can be used to remove points that
were previously selected."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WaverideR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stratigraphy/WaverideR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Track the period of a cycle in a wavelet or superlet scalogram</h1>
    <small class="dont-index">Source: <a href="https://github.com/stratigraphy/WaverideR/blob/HEAD/R/track_period.R" class="external-link"><code>R/track_period.R</code></a></small>
    <div class="hidden name"><code>track_period.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Interactively select points in a wavelet or superlet power spectrum
to trace the evolution of a cycle with changing period.</p>
<p>The <code>track_period</code> function plots a time-frequency spectrum
in which spectral peaks can be selected to track a ridge through time
or depth. This allows the user to follow a cycle whose period varies
along the record.</p>
<p>Tracking points are selected interactively and displayed as white dots.
Previously selected points can be deselected by clicking them again,
after which they are shown as red dots. Because points may be closely
spaced, de-selection can be difficult. In such cases,
<code><a href="delpts_tracked_period_wt.html">delpts_tracked_period_wt</a></code> can be used to remove points that
were previously selected.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">track_period</span><span class="op">(</span></span>
<span>  scalogram <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  astro_cycle <span class="op">=</span> <span class="fl">405</span>,</span>
<span>  n.levels <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  track_peaks <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  periodlab <span class="op">=</span> <span class="st">"Period (metres)"</span>,</span>
<span>  x_lab <span class="op">=</span> <span class="st">"depth (metres)"</span>,</span>
<span>  palette_name <span class="op">=</span> <span class="st">"rainbow"</span>,</span>
<span>  color_brewer <span class="op">=</span> <span class="st">"grDevices"</span>,</span>
<span>  plot_horizontal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_dir <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lowerPeriod <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  upperPeriod <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_lines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_points <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_abline_h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_abline_v <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-scalogram">scalogram<a class="anchor" aria-label="anchor" href="#arg-scalogram"></a></dt>
<dd><p>A wavelet or superlet object created using
<code><a href="analyze_wavelet.html">analyze_wavelet</a></code> or <code><a href="analyze_superlet.html">analyze_superlet</a></code>.</p></dd>


<dt id="arg-astro-cycle">astro_cycle<a class="anchor" aria-label="anchor" href="#arg-astro-cycle"></a></dt>
<dd><p>Duration (in kyr) of the astronomical cycle that is being tracked.</p></dd>


<dt id="arg-n-levels">n.levels<a class="anchor" aria-label="anchor" href="#arg-n-levels"></a></dt>
<dd><p>Number of colour levels used for plotting.
Default is <code>100</code>.</p></dd>


<dt id="arg-track-peaks">track_peaks<a class="anchor" aria-label="anchor" href="#arg-track-peaks"></a></dt>
<dd><p>Logical flag indicating whether tracking is restricted to spectral
peaks (<code>TRUE</code>) or whether any point within the spectrum can be
selected (<code>FALSE</code>). Default is <code>TRUE</code>.</p></dd>


<dt id="arg-periodlab">periodlab<a class="anchor" aria-label="anchor" href="#arg-periodlab"></a></dt>
<dd><p>Label for the period axis.
Default is <code>"Period (metres)"</code>.</p></dd>


<dt id="arg-x-lab">x_lab<a class="anchor" aria-label="anchor" href="#arg-x-lab"></a></dt>
<dd><p>Label for the x-axis.
Default is <code>"depth (metres)"</code>.</p></dd>


<dt id="arg-palette-name">palette_name<a class="anchor" aria-label="anchor" href="#arg-palette-name"></a></dt>
<dd><p>Name of the colour palette used for plotting.</p></dd>


<dt id="arg-color-brewer">color_brewer<a class="anchor" aria-label="anchor" href="#arg-color-brewer"></a></dt>
<dd><p>Name of the R package from which the colour palette is selected.
Supported packages are <code>RColorBrewer</code>, <code>grDevices</code>,
<code>ColorRamps</code>, and <code>viridis</code>.
Default is <code>"grDevices"</code>.</p></dd>


<dt id="arg-plot-horizontal">plot_horizontal<a class="anchor" aria-label="anchor" href="#arg-plot-horizontal"></a></dt>
<dd><p>Logical flag indicating whether the spectrum is plotted horizontally
or vertically. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-plot-dir">plot_dir<a class="anchor" aria-label="anchor" href="#arg-plot-dir"></a></dt>
<dd><p>Logical flag defining the direction of the record.
If time increases with increasing depth (e.g. borehole data),
set to <code>TRUE</code>. If time decreases with increasing depth,
set to <code>FALSE</code>. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-lowerperiod">lowerPeriod<a class="anchor" aria-label="anchor" href="#arg-lowerperiod"></a></dt>
<dd><p>Lowest period value to be displayed.</p></dd>


<dt id="arg-upperperiod">upperPeriod<a class="anchor" aria-label="anchor" href="#arg-upperperiod"></a></dt>
<dd><p>Highest period value to be displayed.</p></dd>


<dt id="arg-add-lines">add_lines<a class="anchor" aria-label="anchor" href="#arg-add-lines"></a></dt>
<dd><p>Optional matrix of additional lines to overlay on the spectrum.
The first column must be depth or time, and subsequent columns
contain period values.</p></dd>


<dt id="arg-add-points">add_points<a class="anchor" aria-label="anchor" href="#arg-add-points"></a></dt>
<dd><p>Optional matrix of additional points to overlay on the spectrum.
The first column must be depth or time, and subsequent columns
contain period values.</p></dd>


<dt id="arg-add-abline-h">add_abline_h<a class="anchor" aria-label="anchor" href="#arg-add-abline-h"></a></dt>
<dd><p>Optional numeric vector specifying horizontal reference lines.</p></dd>


<dt id="arg-add-abline-v">add_abline_v<a class="anchor" aria-label="anchor" href="#arg-add-abline-v"></a></dt>
<dd><p>Optional numeric vector specifying vertical reference lines.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame with three columns:
  first - depth - Depth or time of the tracked points
  second -  period - Tracked period of the cycle
  third  - sedrate - Estimated sedimentation rate based on the cycle duration</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Routines for astrochronologic testing, astronomical time-scale construction,
and time series analysis.
<a href="https://doi.org/10.1016/j.earscirev.2018.11.015" class="external-link">doi:10.1016/j.earscirev.2018.11.015</a></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>The function is based on and inspired by the
 <a href="https://rdrr.io/pkg/astrochron/man/traceFreq.html" class="external-link">traceFreq</a> function from the astrochron package.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Track the 405 kyr eccentricity cycle in a magnetic susceptibility record</span></span></span>
<span class="r-in"><span><span class="va">mag_wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="analyze_wavelet.html">analyze_wavelet</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">mag</span>,</span></span>
<span class="r-in"><span>  dj <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>  lowerPeriod <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>  upperPeriod <span class="op">=</span> <span class="fl">254</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  omega_nr <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mag_track</span> <span class="op">&lt;-</span> <span class="fu">track_period</span><span class="op">(</span></span></span>
<span class="r-in"><span>  scalogram <span class="op">=</span> <span class="va">mag_wt</span>,</span></span>
<span class="r-in"><span>  astro_cycle <span class="op">=</span> <span class="fl">405</span>,</span></span>
<span class="r-in"><span>  track_peaks <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michiel Arts.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

