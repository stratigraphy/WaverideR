<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extract amplitude from a signal — extract_amplitude • WaverideR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Extract amplitude from a signal — extract_amplitude"><meta property="og:description" content="Extracts the amplitude from a signal using the continuous wavelet transform using a Morlet wavelet.
The extraction of the amplitude is useful for cyclostratigraphic studies because the amplitude of
an astronomical cycle is modulated by higher order astronomical cycles."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WaverideR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stratigraphy/WaverideR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract amplitude from a signal</h1>
    <small class="dont-index">Source: <a href="https://github.com/stratigraphy/WaverideR/blob/HEAD/R/extract_amplitude.R" class="external-link"><code>R/extract_amplitude.R</code></a></small>
    <div class="hidden name"><code>extract_amplitude.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extracts the amplitude from a signal using the continuous wavelet transform using a Morlet wavelet.
The extraction of the amplitude is useful for cyclostratigraphic studies because the amplitude of
an astronomical cycle is modulated by higher order astronomical cycles.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extract_amplitude</span><span class="op">(</span></span>
<span>  signal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pts <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  genplot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  remean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ver_results <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keep_editable <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-signal">signal<a class="anchor" aria-label="anchor" href="#arg-signal"></a></dt>
<dd><p>Input signal from which the amplitude is extracted any signal in which the first column is
depth/time and the second column is the proxy record from which the amplitude is extracted</p></dd>


<dt id="arg-pts">pts<a class="anchor" aria-label="anchor" href="#arg-pts"></a></dt>
<dd><p>The pts parameter specifies how many points to the left/right up/down the peak detect algorithm goes in detecting
a peak. The peak detecting algorithm works by comparing the values left/right up/down of it, if the values are both higher or lower
then the value a peak. To deal with error produced by this algorithm the pts parameter can be changed which can
aid in peak detection. Usually increasing the pts parameter means more peak certainty, however it also means that minor peaks might not be
picked up by the algorithm <code>Default=3</code></p></dd>


<dt id="arg-genplot">genplot<a class="anchor" aria-label="anchor" href="#arg-genplot"></a></dt>
<dd><p>If set to TRUE a plot with extracted amplitude will be displayed <code>Default=FALSE</code>.</p></dd>


<dt id="arg-remean">remean<a class="anchor" aria-label="anchor" href="#arg-remean"></a></dt>
<dd><p>Prior to analysis the mean is subtracted from the data set to re-mean set <code>Default=TRUE</code>.</p></dd>


<dt id="arg-ver-results">ver_results<a class="anchor" aria-label="anchor" href="#arg-ver-results"></a></dt>
<dd><p>To verify the amplitude extraction is representative of the amplitude
extracted using the <code>extract_amplitude</code> function the results can be compared to the amplitude extracted
using the <code><a href="Hilbert_transform.html">Hilbert_transform</a></code> if the mean difference is more then 5<!-- % one might need to reconsider -->
whether the input contains a reliable enough signal with high a enough amplitude modulation to actually extract an amplitude from. <code>Default=FALSE</code>.</p></dd>


<dt id="arg-keep-editable">keep_editable<a class="anchor" aria-label="anchor" href="#arg-keep-editable"></a></dt>
<dd><p>Keep option to add extra features after plotting  <code>Default=FALSE</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a matrix with 2 columns.
The first column is depth/time.
The second column is the extracted amplitude</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Angi Roesch and Harald Schmidbauer (2018). WaveletComp: Computational
Wavelet Analysis. R package version 1.1.
<a href="https://CRAN.R-project.org/package=WaveletComp" class="external-link">https://CRAN.R-project.org/package=WaveletComp</a></p>
<p>Gouhier TC, Grinsted A, Simko V (2021). R package biwavelet: Conduct Univariate and Bivariate Wavelet Analyses. (Version 0.20.21),
<a href="https://github.com/tgouhier/biwavelet" class="external-link">https://github.com/tgouhier/biwavelet</a></p>
<p>Torrence, C., and G. P. Compo. 1998. A Practical Guide to Wavelet Analysis.
Bulletin of the American Meteorological Society 79:61-78.
<a href="https://paos.colorado.edu/research/wavelets/bams_79_01_0061.pdf" class="external-link">https://paos.colorado.edu/research/wavelets/bams_79_01_0061.pdf</a></p>
<p>Morlet, Jean, Georges Arens, Eliane Fourgeau, and Dominique Glard.
"Wave propagation and sampling theory—Part I: Complex signal and scattering in multilayered media.
" Geophysics 47, no. 2 (1982): 203-221.</p>
<p>J. Morlet, G. Arens, E. Fourgeau, D. Giard;
Wave propagation and sampling theory; Part II, Sampling theory and complex waves.
 Geophysics 1982 47 (2): 222–236.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Code based on the reconstruct function of the 'WaveletComp' R package
which is based on the wavelet 'MATLAB' code written by Christopher Torrence and Gibert P. Compo.
The assignment of the standard deviation of the uncertainty of the wavelet
is based on the work of Gabor (1946) and Russell et al., (2016)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">#Extract amplitude of the 405 kyr eccentricity cycle from the the magnetic</span></span></span>
<span class="r-in"><span><span class="co"># susceptibility data set of De pas et al., (2018)</span></span></span>
<span class="r-in"><span><span class="co">#Perform the CWT on the magnetic susceptibility data set of Pas et al., (2018)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mag_wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="analyze_wavelet.html">analyze_wavelet</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mag</span>,</span></span>
<span class="r-in"><span>dj <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>lowerPeriod <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>upperPeriod <span class="op">=</span> <span class="fl">254</span>,</span></span>
<span class="r-in"><span>verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>omega_nr <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Track the 405 kyr eccentricity cycle in a wavelet spectra</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#mag_track &lt;- track_period_wavelet(astro_cycle = 405,</span></span></span>
<span class="r-in"><span><span class="co">#                                   wavelet=mag_wt,</span></span></span>
<span class="r-in"><span><span class="co">#                                   n.levels = 100,</span></span></span>
<span class="r-in"><span><span class="co">#                                   periodlab = "Period (metres)",</span></span></span>
<span class="r-in"><span><span class="co">#                                   x_lab = "depth (metres)")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Instead of tracking, the tracked solution data set mag_track_solution</span></span></span>
<span class="r-in"><span><span class="co">#is used</span></span></span>
<span class="r-in"><span><span class="va">mag_track</span> <span class="op">&lt;-</span> <span class="va">mag_track_solution</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mag_track_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="completed_series.html">completed_series</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  wavelet <span class="op">=</span> <span class="va">mag_wt</span>,</span></span>
<span class="r-in"><span>  tracked_curve <span class="op">=</span> <span class="va">mag_track</span>,</span></span>
<span class="r-in"><span>  period_up <span class="op">=</span> <span class="fl">1.2</span>,</span></span>
<span class="r-in"><span>  period_down <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>  extrapolate <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  genplot <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Smooth the completed tracking of the 405 kyr eccentricity cycle in the wavelet spectra</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mag_track_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="loess_auto.html">loess_auto</a></span><span class="op">(</span>time_series <span class="op">=</span> <span class="va">mag_track_complete</span>,</span></span>
<span class="r-in"><span>genplot <span class="op">=</span> <span class="cn">FALSE</span>, print_span <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mag_405_ecc</span>  <span class="op">&lt;-</span> <span class="fu"><a href="extract_signal.html">extract_signal</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>tracked_cycle_curve <span class="op">=</span> <span class="va">mag_track_complete</span>,</span></span>
<span class="r-in"><span>wavelet <span class="op">=</span> <span class="va">mag_wt</span>,</span></span>
<span class="r-in"><span>period_up <span class="op">=</span> <span class="fl">1.2</span>,</span></span>
<span class="r-in"><span>period_down <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>add_mean <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>tracked_cycle_period <span class="op">=</span> <span class="fl">405</span>,</span></span>
<span class="r-in"><span>extract_cycle <span class="op">=</span> <span class="fl">405</span>,</span></span>
<span class="r-in"><span>tune <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>plot_residual <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#extract the amplitude  of the 405 kyr eccentricity cycle</span></span></span>
<span class="r-in"><span><span class="va">mag_ampl</span> <span class="op">&lt;-</span> <span class="fu">extract_amplitude</span><span class="op">(</span></span></span>
<span class="r-in"><span>signal <span class="op">=</span> <span class="va">mag_405_ecc</span>,</span></span>
<span class="r-in"><span>pts<span class="op">=</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>genplot <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>ver_results <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>keep_editable<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michiel Arts.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

